# Enhancing Portfolio Optimization via Adversarial Reinforcement Learning

This repository contains a code implementation of the Master Thesis **Enhancing Portfolio Optimization via Adversarial Reinforcement Learning** written by Matvey Lukyanov 2024.

## Idea

This project explores an innovative approach to portfolio optimization through the application of adversarial reinforcement learning. The primary objective is to train a portfolio optimization agent to maximize portfolio returns while simultaneously training a market dynamics agent to minimize these returns by manipulating market conditions such as drifts, volatilities, and correlations, modeled via Geometrical Brownian motion. In this adversarial framework, the portfolio agent learns to optimize under the most challenging market scenarios generated by the market agent. The training process involves obtaining pretrained weights for the portfolio agent by solving the adversarial reinforcement learning task. These pretrained weights are then used as the initial parameters for a subsequent optimization task involving real market data. The effectiveness of this approach is validated by comparing the performance of the pretrained portfolio agent against a baseline portfolio agent that is trained directly on real market data without adversarial pretraining. The hypothesis is that the adversarially pretrained portfolio agent will demonstrate superior robustness and efficiency in optimizing portfolio returns in real-world market conditions. This research aims to contribute to the field of financial engineering by providing a novel methodology for enhancing portfolio optimization strategies through adversarial reinforcement learning, potentially offering a more resilient and effective approach to managing investment portfolios.

## Acknowledgemetns
This project uses [Regelum](https://regelum.aidynamic.io/) framework, made by AIDA lab.  Detailed documentation is available [here](https://regelum.aidynamic.io/).

## Repo description

* [`presets`](presets) — folder containing configs with all hyperparameters 

* [`src`](src) — folder containing all `.py` files - mainly inheritance from regelum repo.

* [`imgs`](imgs) — folder containing images of the project.

* [`launch.json`](.vscode/launch.json) — in case of work in vscode this config will help to rin and debug the repo more smoothly

* [`requirements.txt`](requirements.txt) — list with all needed dependencies for the repo run

* [`experiments.ipynb`](experiments.ipynb) — analysis of obtained callbacks, created by the script

* [`run.py`](run.py) — script to run the model


## Prerequisites
```commandline
git clone https://github.com/Matteus1904/portfolio_opt_regelum
cd portfolio_opt_regelum
pip install -r requirements.txt
```

## Running
To reproduce results, you just ran the `run.py ` using Python kernel with neccesary packages (installed in Prerequisites section). The code was tested in `Python 3.9.16`. The code execution in other Python versions is not guaranteed.

To run the default experiments in parallel, use the following command:
```
python run.py --single-thread --parallel
```
or in the following way to run sequentially:

```
python run.py
```
It will save the results into `regelum_data` folder.


## Numerical results
Below numerical results can be seen:

|                              | Sharpe ratio       | PnL            |
|------------------------------|--------------------|----------------|
| No active trading            | 0.0309             | 5.702          |
|                              | *(0.0321)*         | *(9.419)*      |
| Learning purely on history   | 0.0285             | 4.804          |
|                              | *(0.0305)*         | *(8.684)*      |
| Learning against fixed market| 0.0254             | 3.728          |
|                              | *(0.0275)*         | *(7.997)*      |
| Learning against random market| 0.0355            | 6.118          |
|                              | *(0.0336)*         | *(8.558)*      |
| Learning against strategic market | **0.0485** * | **13.096** *   |
|                              | *(0.0469)*         | *(16.861)*     |
